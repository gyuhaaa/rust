# YOU_MUST_KNOW

## 1. 제네시스 블록의 의미
- 제네시스 블록은 블록체인의 시작점입니다. 부모가 없기 때문에 네트워크가 공유하는 하나의 고정된 기준으로 사용됩니다.
- Reth를 포함한 모든 이더리움 클라이언트는 제네시스의 해시와 상태를 하드코딩하거나 설정 파일로 불러옵니다. 우리가 만드는 헤더 버퍼에서도 제네시스를 가장 먼저 넣어 기준점을 세워야 합니다.

## 2. 블록 헤더가 담는 핵심 정보
- 블록 번호(`number`): 체인에서의 위치를 나타내며, 부모 번호보다 항상 1 크야 합니다.
- 블록 해시(`hash`): 헤더 전체를 해싱한 값으로, 체인에서 블록을 식별하는 ID입니다.
- 부모 해시(`parent_hash`): 이전 블록의 해시로, 체인을 연결하는 고리 역할을 합니다.
- 난이도(`difficulty`): 작업증명(Proof-of-Work) 기반 체인에서 블록을 찾기 위해 필요한 작업량을 표현합니다. Reth는 현재 PoS 체인에서도 과거 호환성을 위해 total difficulty를 추적합니다.

## 3. Total Difficulty란?
- 체인에서 각 블록의 난이도를 모두 더한 값입니다. PoW 체인에서는 이 값이 가장 높은 체인이 "가장 많은 작업이 들어간 정당한 체인"으로 간주됩니다.
- 난이도는 `u64` 범위지만 누적하다 보면 매우 큰 값이 되므로 `u128` 같은 넉넉한 타입으로 합산하는 것이 안전합니다.

## 4. HashMap을 이용한 빠른 조회
- `HashMap<String, usize>` 형태로 `hash -> canonical index`를 저장하면 특정 해시가 있는지 평균 O(1) 시간에 확인할 수 있습니다.
- 이는 Reth가 DB에 인덱스를 저장하고, parent hash를 기반으로 빠르게 헤더를 찾는 방식과 유사합니다.

## 5. 오류 처리를 통한 방어적 프로그래밍
- 헤더 추가 시 부모를 찾지 못하면 체인 연결이 끊긴 것이고, 번호가 어긋나면 중간 블록이 빠진 것입니다.
- 각 오류를 명확한 enum 변형으로 표현하면 나중에 Stage 로직이나 상위 모듈에서 에러를 구체적으로 처리하기 쉬워집니다.
